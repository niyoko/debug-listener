html
  head
    title= title
    style(type="text/css").
      .log-item {
        padding: 0.5rem;
        border-bottom: 1px solid gray;
      }

      .log-item.log-item-error {
        color: red;
      }

      .log-item.log-item-error {
        color: yellow;
      }

      .log-item.log-item-info {
        color: blue;
      }

      .log-item.log-item-trace {
        color: green;
      }

      .log-item .log-item-inner {
        max-height: 3rem;
        overflow: hidden;
      }
  body
    h1= message
    div#logs

    script(src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js")
    script(type="text/javascript").
      (function() {
        const ws = new WebSocket('ws://' + location.host + '/websocket');
        ws.addEventListener('message', function(event) {
          const item = JSON.parse(event.data);
          $('#logs').append(renderItem(item));
        });

        function renderItem(item) {
          const {levelName, time, message} = item;
          const divItem = $('<div />');
          divItem.addClass('log-item');
          divItem.addClass('log-item-' + levelName);

          const divInner = $('<div />');
          divInner.addClass('log-item-inner')
          divInner.text(message);

          divItem.append(divInner);
          return divItem;
        }
      })();